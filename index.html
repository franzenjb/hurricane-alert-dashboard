<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hurricane Alert System - Professional Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        #map { height: 500px; }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .threat-zone { 
            fill: rgba(255, 0, 0, 0.2); 
            stroke: red; 
            stroke-width: 2;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <div x-data="hurricaneApp()" x-init="init()" class="min-h-screen">
        <!-- Alert Banner -->
        <div x-show="alertLevel !== 'green'" 
             :class="{
                 'bg-red-600': alertLevel === 'red',
                 'bg-orange-500': alertLevel === 'orange',
                 'bg-yellow-500': alertLevel === 'yellow'
             }"
             class="text-white p-3 text-center font-bold pulse">
            <span x-text="alertMessage"></span>
        </div>

        <!-- Header -->
        <header class="bg-gray-800 shadow-lg">
            <div class="container mx-auto px-4 py-6">
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-3xl font-bold flex items-center gap-2">
                            ðŸŒ€ Hurricane Alert System
                            <span class="text-sm font-normal text-gray-400">Professional Grade</span>
                        </h1>
                        <p class="text-gray-400 mt-1">NHC TWO â€¢ GIS Polygons â€¢ CurrentStorms â€¢ Florida AOI</p>
                    </div>
                    <div class="text-right">
                        <div class="text-2xl font-bold" :class="{
                            'text-green-400': alertLevel === 'green',
                            'text-yellow-400': alertLevel === 'yellow',
                            'text-orange-400': alertLevel === 'orange',
                            'text-red-400': alertLevel === 'red'
                        }">
                            <span x-text="alertLevel.toUpperCase()"></span> ALERT
                        </div>
                        <div class="text-sm text-gray-400" x-text="'Last: ' + lastUpdate"></div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Dashboard -->
        <div class="container mx-auto px-4 py-6">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- Left Column - Stats & Active Systems -->
                <div class="lg:col-span-1 space-y-6">
                    
                    <!-- Quick Stats -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <h2 class="text-xl font-bold mb-4">Current Status</h2>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-gray-700 rounded p-3">
                                <div class="text-3xl font-bold" x-text="totalSystems"></div>
                                <div class="text-sm text-gray-400">Total Systems</div>
                            </div>
                            <div class="bg-gray-700 rounded p-3">
                                <div class="text-3xl font-bold text-orange-400" x-text="floridaThreats"></div>
                                <div class="text-sm text-gray-400">FL Threats</div>
                            </div>
                            <div class="bg-gray-700 rounded p-3">
                                <div class="text-3xl font-bold text-red-400" x-text="activeStorms.length"></div>
                                <div class="text-sm text-gray-400">Active Storms</div>
                            </div>
                            <div class="bg-gray-700 rounded p-3">
                                <div class="text-3xl font-bold text-yellow-400" x-text="potentialSystems.length"></div>
                                <div class="text-sm text-gray-400">Potential</div>
                            </div>
                        </div>
                    </div>

                    <!-- Active Storms List -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <h2 class="text-xl font-bold mb-4">Active Systems</h2>
                        <div x-show="activeStorms.length === 0" class="text-gray-400">
                            No active storms
                        </div>
                        <div class="space-y-3">
                            <template x-for="storm in activeStorms" :key="storm.id">
                                <div class="bg-gray-700 rounded p-3" :class="{'border-2 border-red-500': storm.threatens_florida}">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <div class="font-bold text-lg" x-text="storm.name"></div>
                                            <div class="text-sm text-gray-400" x-text="storm.classification"></div>
                                        </div>
                                        <span x-show="storm.threatens_florida" 
                                              class="bg-red-500 text-white px-2 py-1 rounded text-xs">
                                            FL THREAT
                                        </span>
                                    </div>
                                    <div class="mt-2 text-sm">
                                        <div>Winds: <span x-text="storm.intensity + ' mph'"></span></div>
                                        <div>Movement: <span x-text="storm.movement + ' at ' + storm.speed + ' mph'"></span></div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Potential Systems -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <h2 class="text-xl font-bold mb-4">Potential Development</h2>
                        <div x-show="potentialSystems.length === 0" class="text-gray-400">
                            No areas of interest
                        </div>
                        <div class="space-y-3">
                            <template x-for="system in potentialSystems" :key="system.id">
                                <div class="bg-gray-700 rounded p-3" :class="{'border-2 border-yellow-500': system.threatens_florida}">
                                    <div class="flex justify-between items-start">
                                        <div class="font-bold" x-text="system.region"></div>
                                        <span x-show="system.threatens_florida" 
                                              class="bg-yellow-500 text-black px-2 py-1 rounded text-xs">
                                            WATCH
                                        </span>
                                    </div>
                                    <div class="mt-2 grid grid-cols-2 gap-2 text-sm">
                                        <div class="bg-gray-800 rounded p-2">
                                            <div class="text-xs text-gray-400">48hr</div>
                                            <div class="font-bold" :class="{
                                                'text-red-400': system.p48 >= 60,
                                                'text-orange-400': system.p48 >= 40,
                                                'text-yellow-400': system.p48 >= 20,
                                                'text-gray-400': system.p48 < 20
                                            }" x-text="system.p48 + '%'"></div>
                                        </div>
                                        <div class="bg-gray-800 rounded p-2">
                                            <div class="text-xs text-gray-400">7-day</div>
                                            <div class="font-bold" :class="{
                                                'text-red-400': system.p7 >= 60,
                                                'text-orange-400': system.p7 >= 40,
                                                'text-yellow-400': system.p7 >= 20,
                                                'text-gray-400': system.p7 < 20
                                            }" x-text="system.p7 + '%'"></div>
                                        </div>
                                    </div>
                                    <div class="mt-2 text-xs text-gray-400 line-clamp-2" x-text="system.text"></div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>

                <!-- Center/Right - Map & Charts -->
                <div class="lg:col-span-2 space-y-6">
                    
                    <!-- Interactive Map -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-bold">Atlantic Basin Activity</h2>
                            <div class="flex gap-2">
                                <button @click="toggleFloridaAOI()" 
                                        class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm">
                                    Toggle FL AOI
                                </button>
                                <button @click="fetchData()" 
                                        class="bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-sm">
                                    ðŸ”„ Refresh
                                </button>
                            </div>
                        </div>
                        <div id="map" class="rounded"></div>
                        <div class="mt-3 flex gap-4 text-xs">
                            <span class="flex items-center gap-1">
                                <span class="w-3 h-3 bg-red-500 rounded-full"></span> Active Storm
                            </span>
                            <span class="flex items-center gap-1">
                                <span class="w-3 h-3 bg-yellow-500 rounded-full"></span> Potential Development
                            </span>
                            <span class="flex items-center gap-1">
                                <span class="w-3 h-3 bg-blue-500 rounded-full"></span> Florida AOI
                            </span>
                        </div>
                    </div>

                    <!-- Probability Chart -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <h2 class="text-xl font-bold mb-4">Development Probability Timeline</h2>
                        <canvas id="probChart" width="400" height="200"></canvas>
                    </div>

                    <!-- Data Sources -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <h2 class="text-xl font-bold mb-4">Data Sources</h2>
                        <div class="grid grid-cols-3 gap-4 text-sm">
                            <div class="bg-gray-700 rounded p-3">
                                <div class="font-bold mb-1">NHC TWO</div>
                                <div class="text-xs text-gray-400">Text parsing</div>
                                <div class="text-green-400">âœ“ Active</div>
                            </div>
                            <div class="bg-gray-700 rounded p-3">
                                <div class="font-bold mb-1">GIS Polygons</div>
                                <div class="text-xs text-gray-400">Spatial analysis</div>
                                <div x-text="gisAvailable ? 'âœ“ Active' : 'â—‹ Pending'" 
                                     :class="gisAvailable ? 'text-green-400' : 'text-gray-400'"></div>
                            </div>
                            <div class="bg-gray-700 rounded p-3">
                                <div class="font-bold mb-1">CurrentStorms</div>
                                <div class="text-xs text-gray-400">Active tracking</div>
                                <div class="text-green-400">âœ“ Active</div>
                            </div>
                        </div>
                    </div>

                    <!-- Alert Log -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <h2 class="text-xl font-bold mb-4">Alert History (24h)</h2>
                        <div class="space-y-2 text-sm">
                            <template x-for="log in alertHistory" :key="log.time">
                                <div class="flex justify-between items-center bg-gray-700 rounded p-2">
                                    <span x-text="log.message"></span>
                                    <span class="text-xs text-gray-400" x-text="log.time"></span>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-gray-800 mt-12 py-6">
            <div class="container mx-auto px-4 text-center text-sm text-gray-400">
                <p>Data: NHC/NOAA â€¢ Updates: Every 30 minutes â€¢ NHC Schedule: 2/8 AM/PM EDT</p>
                <p class="mt-2">Professional Hurricane Tracking System v2.0</p>
            </div>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>